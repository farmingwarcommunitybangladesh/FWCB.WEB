<!DOCTYPE html>
<html lang="bn">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>FWCB Discord & Clans</title>
    <link rel="stylesheet" href="styles.css" />
    <link rel="stylesheet" href="discord-styles.css" />
  </head>
  <body>
    <header>
      <div class="logo">
        <h1>FWCB Community</h1>
        <p>Farming War Community Bangladesh</p>
      </div>
      <button class="mobile-menu-toggle" id="mobile-menu-toggle">
        <span></span>
        <span></span>
        <span></span>
      </button>
      <nav class="nav-menu" id="nav-menu">
        <ul>
          <li><a href="index.html">Home</a></li>
          <li><a href="clans.html">Clans</a></li>
          <li><a href="discord.html" class="active">Discord & Groups</a></li>
          <li><a href="bases.html">Bases</a></li>
          <li><a href="rules.html">Rules</a></li>
          <li><a href="about.html">About Us</a></li>
        </ul>
      </nav>
    </header>

    <!-- Home Button -->
    <a href="index.html" class="home-button">
      <span class="home-icon">üè†</span>
      <span class="home-text">Home</span>
    </a>

    <main>
      <section style="padding: 30px 5%">
        <!-- FWCB Main Box -->
        <div class="discord-box">
          <img src="images/fwcb.png" alt="FWCB" />
          <h2>Farming War Community Bangladesh (FWCB)</h2>
          <p>Join our community for all Bangladesh Clash of Clans players!</p>
          <div class="btn-group">
            <a href="https://www.facebook.com/share/g/19ysq1u8rf/" target="_blank" class="join-btn facebook-join-btn">Facebook Group</a>
            <a href="https://discord.gg/h2Y88VwQ" target="_blank" class="join-btn discord-join-btn">Discord</a>
            <a href="https://m.me/cm/AbYRDF6fu0spC2-g/?send_source=cm%3Acopy_invite_link" target="_blank" class="join-btn messenger-join-btn"
              >Messenger Community</a
            >
            <a href="https://band.us/@cocbangladesh" target="_blank" class="join-btn band-join-btn">Band Community</a>
          </div>
        </div>

        <!-- All Clan Discords -->
        <div class="section-header">
          <h2>Clan Discords & Groups</h2>
          <p>Connect with individual clan communities</p>
        </div>
        <div class="clan-discord-grid" id="clan-discord-list">
          <!-- Clan boxes will be loaded here -->
        </div>
      </section>
    </main>
    <footer>
      <p>&copy; 2025 Farming War Bangladesh Community. All rights reserved.</p>
    </footer>
    <script>
      document.addEventListener("DOMContentLoaded", async () => {
        const list = document.getElementById("clan-discord-list");
        if (!list) return;

        try {
          // Fetch database
          const response = await fetch("clans.json");
          const clans = await response.json();

          // Sort by Level
          clans.sort((a, b) => b.level - a.level);

          list.innerHTML = clans
            .map((clan) => {
              // If discord link is missing, disable button
              const hasDiscord = clan.discord && clan.discord !== "#";
              const btnStyle = hasDiscord ? "" : "opacity:0.5; cursor:not-allowed; background:#333 !important;";
              const btnText = hasDiscord ? "Join Discord" : "No Discord";
              const link = hasDiscord ? clan.discord : "javascript:void(0)";

              return `
                <div class="clan-discord-card">
                    <div class="clan-discord-logo" 
                         style="background-image:url('${clan.badgeUrl}'); background-size:contain; background-repeat:no-repeat; background-color:transparent;">
                    </div>
                    <div class="clan-discord-name">${clan.name}</div>
                    <a href="${link}" target="_blank" class="join-btn discord-join-btn" style="${btnStyle}">
                        ${btnText}
                    </a>
                </div>
                `;
            })
            .join("");
        } catch (e) {
          console.error(e);
          list.innerHTML = "<p style='text-align:center'>Failed to load discord list.</p>";
        }

        // Mobile Menu Logic (Preserved)
        const mobileMenuToggle = document.getElementById("mobile-menu-toggle");
        const navMenu = document.getElementById("nav-menu");
        if (mobileMenuToggle && navMenu) {
          mobileMenuToggle.addEventListener("click", () => {
            mobileMenuToggle.classList.toggle("active");
            navMenu.classList.toggle("active");
          });
          document.addEventListener("click", (e) => {
            if (!mobileMenuToggle.contains(e.target) && !navMenu.contains(e.target)) {
              mobileMenuToggle.classList.remove("active");
              navMenu.classList.remove("active");
            }
          });
        }
      });

      // Home Button Scroll Detection
      const homeButton = document.querySelector(".home-button");
      window.addEventListener("scroll", () => {
        if (window.pageYOffset > 100) homeButton.classList.add("show");
        else homeButton.classList.remove("show");
      });
    </script>
  </body>
</html>
